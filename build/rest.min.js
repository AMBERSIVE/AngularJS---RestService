angular.module("ambersive.rest",[]),angular.module("ambersive.rest").factory("RestSrv",["$http",function(a){var b={};return b.config={auth:{storageName:"accessToken",storageValidDays:7,tokenName:"accessToken",tokenType:"Bearer "},contentType:"application/json; charset=utf-8;",errorHandling:{on401:function(a){a&&a()},on403:function(a){a&&a()}}},b.response=function(a,b){return b?"function"!=typeof b?a:void b(a):a},b.helper={cookies:{get:function(a,c){for(var d=a+"=",e="",f=document.cookie.split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);0===h.indexOf(d)&&(e=h.substring(d.length,h.length))}return b.response(e,c)},update:function(a,c,d,e){var f="";if(0===d)f="expires=0";else{var g=new Date;g.setTime(g.getTime()+24*d*60*60*1e3),f="expires="+g.toUTCString()}return document.cookie=a+"="+c+"; "+f+";path=/",b.response(b.helper.cookies.get(a),e)},"delete":function(a){b.helper.cookies.update(a,"",-100)}}},b.errorHandling={load:function(a){var c;return void 0!==b.config.errorHandling["on"+a]&&(c=b.config.errorHandling["on"+a]),c}},b.token={get:function(a){var c=null;try{return c=b.helper.cookies.get(b.config.auth.storageName),b.response(c,a)}catch(d){return b.response(c,a)}},set:function(a){null!==a&&void 0!==a&&""!==a&&b.helper.cookies.update(b.config.auth.storageName,a,b.config.auth.storageValidDays)},fromHeader:function(a){void 0!==a(b.config.auth.tokenName)&&null!==a(b.config.auth.tokenName)&&b.token.set(a(b.config.auth.tokenName))}},b.auth={get:function(c){return b.response(a["default"].headers.common.Authorization,c)},set:function(c,d){var e=!1;void 0!==c&&null!==c&&""!==c&&b.token.set(c),b.token.get(function(c){return void 0===c&&(c=null),null===c&&(a["default"].headers.common.Authorization=b.config.auth.tokenType+c,e=!0),b.response(e,d)})}},b.call=function(c,d){var e={status:412};try{if(void 0===c)throw e.msg="$http req object ist missing",e;switch(b.auth.set(),c.method){case"DELETE":void 0===c.headers&&(c.headers={},c.headers["Content-Type"]=b.config.contentType)}a(c).success(function(a,c,f,g){switch(e.status=c,e.data=a,void 0!==a.status&&(e.status=a.status),void 0!==f&&b.token.fromHeader(f),e.status){case 401:case 403:var h=b.errorHandling(e.status);void 0!==h&&"function"==typeof h&&h(function(){return b.response(e,d)});break;case 500:throw e;default:return b.response(e,d)}}).error(function(a,c,f,g){return e.status=c,e.data=a,b.response(e,d)})}catch(f){return e.status=500,e.msg=f,b.response(e,d)}},b}]);