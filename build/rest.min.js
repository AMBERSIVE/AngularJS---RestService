angular.module("ambersive.rest",[]),angular.module("ambersive.rest").factory("RestSrv",["$http","$log",function(a,b){var c={};return c.config={auth:{storageName:"accessToken",storageValidDays:7,tokenName:"accessToken",tokenType:"Bearer "},contentType:"application/json; charset=utf-8;",errorHandling:{on401:function(a){a&&a()},on403:function(a){a&&a()},on500:function(a){a&&a()}}},c.response=function(a,b){return b?"function"!=typeof b?a:void b(a):a},c.helper={cookies:{get:function(a,b){for(var d=a+"=",e="",f=document.cookie.split(";"),g=0;g<f.length;g++){for(var h=f[g];" "==h.charAt(0);)h=h.substring(1);0===h.indexOf(d)&&(e=h.substring(d.length,h.length))}return c.response(e,b)},update:function(a,b,d,e){var f="";if(0===d)f="expires=0";else{var g=new Date;g.setTime(g.getTime()+24*d*60*60*1e3),f="expires="+g.toUTCString()}return document.cookie=a+"="+b+"; "+f+";path=/",c.response(c.helper.cookies.get(a),e)},"delete":function(a){c.helper.cookies.update(a,"",-100)}}},c.errorHandling={load:function(a){var b;return void 0!==c.config.errorHandling["on"+a]&&(b=c.config.errorHandling["on"+a]),b}},c.token={get:function(a){var b=null;try{return b=c.helper.cookies.get(c.config.auth.storageName),c.response(b,a)}catch(d){return c.response(b,a)}},set:function(a){null!==a&&void 0!==a&&""!==a&&c.helper.cookies.update(c.config.auth.storageName,a,c.config.auth.storageValidDays)},fromHeader:function(a){void 0!==a(c.config.auth.storageName)&&null!==a(c.config.auth.storageName)&&c.token.set(a(c.config.auth.storageName))}},c.auth={get:function(b){return c.response(a["default"].headers.common.Authorization,b)},set:function(d,e){var f=!1;void 0!==d&&null!==d&&""!==d&&c.token.set(d),c.token.get(function(d){if(void 0===d&&(d=null),null!==d){try{a.defaults.headers.common[c.config.auth.tokenName]=c.config.auth.tokenType+d}catch(g){b.warn(g)}try{a.defaults.headers.common.Authorization=c.config.auth.tokenType+d}catch(g){b.warn(g)}f=!0}return c.response(f,e)})}},c.call=function(d,e){var f={status:412};try{if(void 0===d)throw f.msg="$http req object ist missing",f;switch(c.auth.set(),d.method){case"DELETE":void 0===d.headers&&(d.headers={},d.headers["Content-Type"]=c.config.contentType)}a(d).success(function(a,d,g,h){switch(f.status=d,f.data=a,b.log(a),void 0!==a.status&&(f.status=a.status),void 0!==a.data&&(f.data=a.data),void 0!==g&&c.token.fromHeader(g),f.status){case 401:case 403:case 500:var i=c.errorHandling.load(f.status);void 0!==i&&"function"==typeof i&&i(function(){return c.response(f,e)});break;default:return c.response(f,e)}}).error(function(a,b,d,g){switch(0===b&&(b=400),f.status=b,f.status){case 401:case 403:case 500:var h=c.errorHandling.load(f.status);void 0!==h&&"function"==typeof h&&h(function(){return c.response(f,e)});break;default:return void 0!==a&&null!==a&&(void 0!==a.status&&(f.status=a.status),f.data=a,void 0!==a.data&&(f.data=a.data)),c.response(f,e)}})}catch(g){return f.status=500,f.msg=g,c.response(f,e)}},c}]);